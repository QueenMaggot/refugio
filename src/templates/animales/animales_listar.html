<!-- LISTADO DE ANIMALES -->
{% extends "base.html" %}
{% load static %}
{% block contenedor %} 


<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2>Listado de Animales</h2>
    {% if perms.animales.add_animal %}
      <a href="{% url 'animales:animal_create' %}" class="btn btn-success me-2">
        Agregar Animal <img src = "{% static 'img/agregar.png' %}" style= "height: 40px"> </img>
      </a>
    {% endif %}
  </div>

<!-- FILTRADO  -->
<form method="get" class="mb-4">
  <div class="row">
    <!-- Especie -->
    <div class="col-md-3 mb-3">
      <label>Especie:</label>
      {{ filter.form.especie }}
    </div>
    
    <!-- Sexo
        <div class="col-md-3 mb-3">
      <label>Sexo:</label>
      {{ filter.form.sexo }}
    </div>
    -->

  <div class="col-md-3 mb-3">
  <label>Sexo:</label>
  {% for radio in filter.form.sexo %}
    <div class="form-check">
      {{ radio.tag }}
      {% if radio.choice_label == "Macho" %} Macho
        <img src="{%static "img/paw-azul.png" %}" style= "height:20px"> 
      {% elif radio.choice_label == "Hembra" %} Hembra
        <img src="{%static "img/paw-rosa.png" %}" style= "height:20px">
      {% endif %}
    </div>
  {% endfor %}
  </div>


    
    <!-- Adoptado -->
    <div class="col-md-3 mb-3">
      <label>Adoptado:</label>
      {{ filter.form.adoptado }}
    </div>
    
    <!-- Botones -->
    <div class="col-md-3 mb-3">
      <button type="submit" class="btn btn-primary">Filtrar
        <img src ="{% static 'img/gato-lupa.png' %}"  style="height:40px">  
      </button>
      <a href="{% url 'animales:animal_list' %}" class="btn btn-secondary">Limpiar
        <img src ="{% static 'img/gato-delete.png' %}"  style="height:40px">
      </a>
    </div>
  </div>
</form>
<!-- FIN FILTRADO -->


<div class="container">
  <div class="row">
    {% for animal in page_obj %}
      <div class="col-md-4 mb-4">
        <div class="card text-center">
          {% if animal.foto %}
            <img src="{{ animal.foto.url }}" class="card-img-top" alt="{{ animal.nombre }}" style="height:200px; object-fit:cover;">
          {% endif %}
          <div class="card-body">
            <h5 class="card-title">{{ animal.nombre }} 
              {% if animal.sexo == 'H' %} <!-- Si es hembra carga la img rosita-->
              <img src= "{% static 'img/paw-rosa.png' %}" style="height:20px"> </img>
              {% else %}  <!-- Si es macho carga la img azul -->
              <img src= "{% static 'img/paw-azul.png' %}" style="height:20px"> </img>
              {% endif %}
              Edad: {{ animal.edad }}
            </h5>
            <p class="card-text">{{ animal.descripcion }}</p>
  
            <!--{% if perms.animales.view_animal%} {% endif %}-->
            <a href="{% url 'animales:animal_detail' animal.id %}" class="btn btn-primary">Ver detalle
              <img src="{%static 'img/gato-detail.png'%}" style="height:40px">
            </a>
            {% if perms.animales.change_animal%} 
              <a href="{% url 'animales:animal_update' animal.id %}" class="btn btn-warning">Editar
                <img src="{%static 'img/gato-edicion.png'%}" style="height:40px">
              </a>
            {% endif %}
            

          </div>
        </div>
      </div>
    {% endfor %}
  </div>
</div>


<!-- PaginaciÃ³n (actualizada para preservar filtros) -->
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">
    {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.previous_page_number }}{% for k, v in request.GET.items %}{% if k != 'page' %}&{{ k }}={{ v }}{% endif %}{% endfor %}">Anterior</a>
      </li>
    {% endif %}

    <li class="page-item active">
      <span class="page-link">{{ page_obj.number }}</span>
    </li>

    {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?page={{ page_obj.next_page_number }}{% for k, v in request.GET.items %}{% if k != 'page' %}&{{ k }}={{ v }}{% endif %}{% endfor %}">Siguiente</a>
      </li>
    {% endif %}
  </ul>
</nav>

{% endblock contenedor %}
